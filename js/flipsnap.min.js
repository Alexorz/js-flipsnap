/**
 * flipsnap.js
 *
 * @version  0.6.2
 * @url http://pxgrid.github.com/js-flipsnap/
 *
 * Copyright 2011 PixelGrid, Inc.
 * Licensed under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 */
!function(t,e,n){function o(t,e){return this instanceof o?this.init(t,e):new o(t,e)}function r(t,e){return t.changedTouches?t.changedTouches[0][e]:t[e]}function i(t){return c(t,function(t){return p.style[t]!==n})}function a(t,e,o){var r=f[e];r?t[r]=o:t[e]!==n?(f[e]=e,t[e]=o):c(v,function(r){var i=u(r)+u(e);return t[i]!==n?(f[e]=i,t[i]=o,!0):void 0})}function s(t){if(p.style[t]!==n)return t;var e;return c(v,function(o){var r=u(o)+u(t);return p.style[r]!==n?(e="-"+o+"-"+t,!0):void 0}),e}function u(t){return t.charAt(0).toUpperCase()+t.substr(1)}function c(t,e){for(var n=0,o=t.length;o>n;n++)if(e(t[n],n))return!0;return!1}function m(t,e,n,o){var r=Math.abs(t-n),i=Math.abs(e-o),a=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));return{x:r,y:i,z:a}}function l(t){var e=t.y/t.z,n=Math.acos(e);return 180/(Math.PI/n)}var p=e.createElement("div"),v=["webkit","moz","o","ms"],f={},d=o.support={},h=!1,P=5,_=55;d.transform3d=i(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),d.transform=i(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"]),d.transition=i(["transitionProperty","WebkitTransitionProperty","MozTransitionProperty","OTransitionProperty","msTransitionProperty"]),d.addEventListener="addEventListener"in t,d.mspointer=t.navigator.msPointerEnabled,d.cssAnimation=(d.transform3d||d.transform)&&d.transition;for(var y=t.requestAnimationFrame,T=0;T<v.length&&!requestAnimationFrame;++T)y=t[v[T]+"RequestAnimationFrame"];y||(requestAnimationFrame=function(t){t()});var g=["touch","mouse"],E={start:{touch:"touchstart",mouse:"mousedown"},move:{touch:"touchmove",mouse:"mousemove"},end:{touch:"touchend",mouse:"mouseup"}};d.addEventListener&&(e.addEventListener("gesturestart",function(){h=!0}),e.addEventListener("gestureend",function(){h=!1})),o.prototype.init=function(t,o){var r=this;if(r.element=t,"string"==typeof t&&(r.element=e.querySelector(t)),!r.element)throw new Error("element not found");return d.mspointer&&(r.element.style.msTouchAction="pan-y"),o=r.opts=o||{},r.distance=n,r.disableTouch=o.disableTouch===n?!1:o.disableTouch,r.disableCssTransition=o.disableCssTransition===n?!1:o.disableCssTransition,r.disable3d=o.disable3d===n?!1:o.disable3d,r.transitionDuration=o.transitionDuration===n?350:o.transitionDuration,r.loop=o.loop===n?!1:{type:o.loop},r.currentPoint=0,r._currentPoint=0,r.maxPoint=n,r._maxPoint=n,r.currentX=0,r.animation=!1,r.use3d=d.transform3d,r.disable3d===!0&&(r.use3d=!1),r._setStyle(d.cssAnimation?{transitionProperty:s("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:r._getTranslate(0)}:{position:"relative",left:"0px"}),r.refresh(),g.forEach(function(t){r.element.addEventListener(E.start[t],r,!1)}),r},o.prototype.handleEvent=function(t){var e=this;switch(t.type){case E.start.touch:e._touchStart(t,"touch");break;case E.start.mouse:e._touchStart(t,"mouse");break;case E.move.touch:e._touchMove(t,"touch");break;case E.move.mouse:e._touchMove(t,"mouse");break;case E.end.touch:e._touchEnd(t,"touch");break;case E.end.mouse:e._touchEnd(t,"mouse");break;case"click":e._click(t)}},o.prototype.refresh=function(){var t=this;if(t.loop&&t.firstLoopFaker&&(t.element.removeChild(t.firstLoopFaker),t.element.removeChild(t.lastLoopFaker)),t._itemLength=function(){for(var e,n=t.element.childNodes,o=0,r=0,i=n.length;i>r;r++)e=n[r],1===e.nodeType&&o++;return o}(),t.maxPoint=t._maxPoint=t.opts.maxPoint===n?t._itemLength-1:t.opts.maxPoint,t.updateDistance(),t.loop){var e=t.element.firstElementChild,o=t.element.lastElementChild;t.firstLoopFaker=e.cloneNode(!0),t.lastLoopFaker=o.cloneNode(!0),t.element.style.width=t.element.scrollWidth+2*t.element.scrollWidth/t._itemLength+"px",t.element.appendChild(t.firstLoopFaker),t.element.insertBefore(t.lastLoopFaker,t.element.firstElementChild),t._itemLength=0===t._itemLength?0:t._itemLength+2,t._maxPoint=0===t._maxPoint?0:t._maxPoint+2}t._maxX=-t._distance*t._maxPoint,t.moveToPoint(0,0)},o.prototype.updateDistance=function(){var t=this;t._distance=t.opts.distance===n?t._maxPoint<0?0:t.element.scrollWidth/(t._maxPoint+1):t.opts.distance},o.prototype.hasNext=function(){var t=this;return t.loop?!0:t.currentPoint<t.maxPoint},o.prototype.hasPrev=function(){var t=this;return t.loop?!0:t.currentPoint>0},o.prototype.toNext=function(t){var e=this;e.hasNext()&&e.moveToPoint(e.currentPoint+1,t)},o.prototype.toPrev=function(t){var e=this;e.hasPrev()&&e.moveToPoint(e.currentPoint-1,t)},o.prototype.moveToPoint=function(t,e,o){var r=this;t===n?t=r.currentPoint:0>t||isNaN(t)?t=0:t>r.maxPoint&&(t=r.maxPoint),r._moveToPoint(r.loop?t+1:t,e,o)},o.prototype._realPointToUserPoint=function(t){return self.loop?1>t?self.maxPoint:t-1:t},o.prototype._moveToPoint=function(t,e,o){var r=this;clearTimeout(r._moveendTimeout),o||(clearTimeout(r._autoPlayTimeout),r._triggerEvent("fsmovestart",!0,!1)),e=e===n?r.transitionDuration:e;{var i=r._realPointToUserPoint(t),a=r.currentPoint;r._currentPoint}r.currentPoint=i,r._currentPoint=t;var s={moved:a!==r.currentPoint,originalPoint:a,newPoint:r.currentPoint},u=function(){r._triggerEvent("fsmoveend",!0,!1,s),r._autoPlay()};d.cssAnimation&&!r.disableCssTransition?(r._setStyle({transitionDuration:e+"ms"}),r._moveendTimeout=setTimeout(u,e)):0!==e&&(r.animation=!0),r._setX(-r._currentPoint*r._distance,e,u),s.moved&&r._triggerEvent("fspointmove",!0,!1,s)},o.prototype._setX=function(t,e,n){var o=this;o.animation?d.cssAnimation&&!o.disableCssTransition?(o.element.style[f.transform]=o._getTranslate(t),o.currentX=t):o._animate(t,e||o.transitionDuration,n):(d.cssAnimation?o.element.style[f.transform]=o._getTranslate(t):o.element.style.left=t+"px",o.currentX=t)},o.prototype._touchStart=function(t,n){var o=this;if(!(o.disableTouch||o.scrolling||h)){clearInterval(o._animateTimer),clearTimeout(o._moveendTimeout),clearTimeout(o._autoPlayTimeout),o.element.addEventListener(E.move[n],o,!1),e.addEventListener(E.end[n],o,!1);var i=t.target.tagName;"mouse"===n&&"SELECT"!==i&&"INPUT"!==i&&"TEXTAREA"!==i&&"BUTTON"!==i&&t.preventDefault(),d.cssAnimation&&o._setStyle({transitionDuration:"0ms"}),o.animation=!1,o.scrolling=!0,o.moveReady=!1,o.startPageX=r(t,"pageX"),o.startPageY=r(t,"pageY"),o.basePageX=o.startPageX,o.directionX=0,o.startTime=t.timeStamp,o._triggerEvent("fstouchstart",!0,!1)}},o.prototype._touchMove=function(t){var e=this;if(e.scrolling&&!h){var o,i,a,s=r(t,"pageX"),u=r(t,"pageY");if(e.moveReady){if(t.preventDefault(),o=s-e.basePageX,i=e.currentX+o,(i>=0||i<e._maxX)&&(i=Math.round(e.currentX+o/3)),a=e.directionX=0===o?e.directionX:o>0?-1:1,e.loop){var c=-1*e._distance,p=-1*e._distance*(e._itemLength-2);-1==a?e.currentX<=c&&i>c?i=e._maxX+i-c:e.currentX>c&&i>=0&&(i=p+i):1==a&&(e.currentX>=p&&p>i?i=0+i-p:e.currentX<p&&i<=e._maxX&&(i=c+i-e._maxX))}var v=!e._triggerEvent("fstouchmove",!0,!0,{delta:o,direction:e.directionX});e._triggerEvent("fsmove",!0,!0,{absoluteX:i}),v?e._touchAfter({moved:!1,originalPoint:e.currentPoint,newPoint:e.currentPoint,cancelled:!0}):e._setX(i)}else{var f=m(e.startPageX,e.startPageY,s,u);f.z>P&&(l(f)>_?(t.preventDefault(),e.moveReady=!0,e.element.addEventListener("click",e,!0),e._triggerEvent("fsmovestart",!0,!1)):(e.scrolling=!1,-1*e.currentPoint*e._distance!=e.currentX&&e.moveToPoint(n,n,!0),e._autoPlay()))}e.basePageX=s}},o.prototype._touchEnd=function(t,o){var r=this;if(r.element.removeEventListener(E.move[o],r,!1),e.removeEventListener(E.end[o],r,!1),r.scrolling){var i,a=-r.currentX/r._distance;a=r.directionX>0?Math.ceil(a):r.directionX<0?Math.floor(a):Math.round(a),0>a?a=0:a>r._maxPoint&&(a=r._maxPoint),i=r._realPointToUserPoint(a),r._touchAfter({moved:i!==r.currentPoint,originalPoint:r.currentPoint,newPoint:i,cancelled:!1}),r._moveToPoint(a,n,!0)}},o.prototype._click=function(t){t.stopPropagation(),t.preventDefault()},o.prototype._touchAfter=function(t){var e=this;e.scrolling=!1,e.moveReady=!1,setTimeout(function(){e.element.removeEventListener("click",e,!0)},200),e._triggerEvent("fstouchend",!0,!1,t)},o.prototype.autoPlay=function(t){return this.enableAutoPlay=!0,this.autoPlayDuration=t||this.autoPlayDuration||4e3,this._autoPlay(),this},o.prototype.stopAutoPlay=function(){return this.enableAutoPlay=!1,clearTimeout(this._autoPlayTimeout),this},o.prototype._autoPlay=function(){var t=this;t.enableAutoPlay&&(clearTimeout(t._autoPlayTimeout),t._autoPlayTimeout=setTimeout(function(){y(function(){t.hasNext()?t.toNext():t.moveToPoint(0),t._autoPlay()})},t.autoPlayDuration))},o.prototype._setStyle=function(t){var e=this,n=e.element.style;for(var o in t)a(n,o,t[o])},o.prototype._animate=function(t,e,n){var o=this,r=o.element,i=+new Date,s=o.currentX,u=t,c=e,m=function(t,e){return-(t/=e)*(t-2)};o._animateTimer=setInterval(function(){var t,e,l=new Date-i;l>c?(clearInterval(o._animateTimer),e=u,setTimeout(function(){"function"==typeof n&&n()},100/6)):(t=m(l,c),e=t*(u-s)+s),d.cssAnimation?a(r.style,"transform",o._getTranslate(e)):r.style.left=e+"px",o.currentX=e,o._triggerEvent("fsmove",!0,!0,{absoluteX:e})},100/6)},o.prototype.destroy=function(){var t=this;g.forEach(function(e){t.element.removeEventListener(E.start[e],t,!1)})},o.prototype._getTranslate=function(t){var e=this;return e.use3d?"translate3d("+t+"px, 0, 0)":"translate("+t+"px, 0)"},o.prototype._triggerEvent=function(t,n,o,r){var i=this,a=e.createEvent("Event");if(a.initEvent(t,n,o),r)for(var s in r)r.hasOwnProperty(s)&&(a[s]=r[s]);return i.element.dispatchEvent(a)},o.prototype.setStyle=a,"object"==typeof exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):t.Flipsnap=o}(window,window.document);